<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="a3fc76d0-acb8-49d2-824d-072a6b88234e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DataDrivenTCforupdateage" searchProperties="true" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:testStep type="groovy" name="DataSourceEmpupdate" id="da09735d-4105-4da2-bdb3-d27ffdfc8a74"><con:settings/><con:config><script>//import Java Excel API library
import jxl.* 
import jxl.write.*
def TestCase = context.testCase
def FilePath = "C:\\Users\\PrithaDutta\\Desktop\\soapui\\Test_Data_for_updateage.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("Propertiesforempupdateage")
count = PropertiesTestStep.getPropertyValue("counter").toInteger()

if (PropertiesTestStep.getPropertyValue("total").toString() == "")
    PropertiesTestStep.setPropertyValue("total", Sheet1.getRows().toString())
count++
//Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
Cell Field2 = Sheet1.getCell(1, count)

log.info("Count is " + count.toString() + " EmpDetails : " + Field1.getContents() + " Empid: " + Field2.getContents())
                
//Close workbook.
WorkBook1.close()
//Copy the Excel test data to properties in Properties test step



//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("EmpDetails", Field1.getContents())
PropertiesTestStep.setPropertyValue("Empid", Field2.getContents())
PropertiesTestStep.setPropertyValue("counter", count.toString())
// check the counter value is less than total no of rows. If same set prop 'end' to 'true'
if (count == PropertiesTestStep.getPropertyValue("total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("end", "true")</script></con:config></con:testStep><con:testStep type="properties" name="Propertiesforempupdateage" id="eaa138bc-f402-49b4-ae13-e39ca5057ef5"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>Empdetails</con:name><con:value/></con:property><con:property><con:name>counter</con:name><con:value>0</con:value></con:property><con:property><con:name>total</con:name><con:value/></con:property><con:property><con:name>end</con:name><con:value>false</con:value></con:property><con:property><con:name>Empid</con:name><con:value/></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="REST Requestforupdate" id="dc5fe0e0-8776-4127-99db-55a7d72b0ea1"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/update/{id}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="REST Requestforupdate" id="22724fe5-b0ae-45ca-ae5f-a6109b548c20" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>	{propertiesforempupdateage#Empdetails}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/update/IBMMANIPAL</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${Properties#Empid}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>empname</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="DataSourceLoopforEmpupdate" id="fe229a8e-80d2-4f8d-9537-04d63d455f94"><con:settings/><con:config><script>// declare context, property step
def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("Propertiesforempupdateage")
// get prop value for 'end'
Stop = PropertiesTestStep.getPropertyValue("end").toString()
if (Stop=="true")
    log.info("DataLoopforEmpupdate")
else
    testRunner.gotoStepByName("DataSourceEmpupdate")    </script></con:config></con:testStep><con:testStep type="groovy" name="CleanupEmpupdate" id="28b00b61-6d29-411e-a6f8-e085def018bf"><con:settings/><con:config><script>def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("Propertiesforempupdateage")
PropertiesTestStep.setPropertyValue("Empdetails","")
PropertiesTestStep.setPropertyValue("Empid","")
PropertiesTestStep.setPropertyValue("counter", "0")
PropertiesTestStep.setPropertyValue("total", "")
PropertiesTestStep.setPropertyValue("end", "false")</script></con:config></con:testStep><con:properties/></con:testCase>