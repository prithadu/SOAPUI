<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="52909714-69ca-4550-89d3-6cf67e5baab7" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DDTrestapicreate" searchProperties="true" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:testStep type="properties" name="propertiesforcreate" id="ff7f2bd5-27fc-4c84-8f62-60a40ab1903c"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>empdetails</con:name><con:value/></con:property><con:property><con:name>Counter</con:name><con:value>0</con:value></con:property><con:property><con:name>Total</con:name><con:value/></con:property><con:property><con:name>end</con:name><con:value>false</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="DataSourceEmpCreate" id="0423f982-65dd-4b74-b3aa-a7288fd9e06a"><con:settings/><con:config><script>// import Java Excel API library
import jxl.* 
import jxl.write.*
def TestCase = context.testCase
def FilePath = "C:\\Users\\PrithaDutta\\Desktop\\soapui\\Test_Data.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("propertiesforcreate")
count = PropertiesTestStep.getPropertyValue("counter").toInteger()
//If Total records is unknown (at start), get the rowcount from Excel
if (PropertiesTestStep.getPropertyValue("total").toString() == "")
    PropertiesTestStep.setPropertyValue("total", Sheet1.getRows().toString())
count++
//Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
log.info("Count is " + count.toString() + " emp details : " + Field1.getContents())
                
//Close workbook.
WorkBook1.close()
//Copy the Excel test data to properties in Properties test step



//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("empdetails", Field1.getContents())

PropertiesTestStep.setPropertyValue("counter", count.toString())
// check the counter value is less than total no of rows. If same set prop 'end' to 'true'
if (count == PropertiesTestStep.getPropertyValue("total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("end", "true")</script></con:config></con:testStep><con:testStep type="groovy" name="DataLoopEmpCreate" id="7c363720-6d2e-4d80-978b-d46d8d67adc5"><con:settings/><con:config><script>// declare context, property step
def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("propertiesforcreate")
// get prop value for 'end'
Stop = PropertiesTestStep.getPropertyValue("end").toString()
if (Stop=="true")
    log.info("DataLoopEmpCreate")
else
    testRunner.gotoStepByName("DataSourceEmpCreate")    </script></con:config></con:testStep><con:testStep type="restrequest" name="RestRequestforcreate" id="1a6e9b34-ac5a-4f06-91a6-ef5e19df47b6"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RestRequestforcreate" id="79dc9257-8b14-45c1-baa3-ef22ce5ccd0d" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>${propertiesforcreate#empdetails}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/create</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="CleanupEmpCreate" id="29f832f6-0e5c-47cd-8f1b-3add4f644888"><con:settings/><con:config><script>def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("propertiesforcreate")
PropertiesTestStep.setPropertyValue("empdetails","")
PropertiesTestStep.setPropertyValue("counter", "0")
PropertiesTestStep.setPropertyValue("total", "")
PropertiesTestStep.setPropertyValue("end", "false")</script></con:config></con:testStep><con:properties/></con:testCase>