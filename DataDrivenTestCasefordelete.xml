<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="8e50825c-19ee-43c6-862d-4b10b38fc7b8" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DataDrivenTestCasefordelete" searchProperties="true" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:testStep type="groovy" name="DataSourceforEmployeeDe" id="f80310cb-f82d-4466-9d84-fea7c31d3ed1"><con:settings/><con:config><script>// import Java Excel API library
import jxl.* 
import jxl.write.*
def TestCase = context.testCase
def FilePath = "C:\\Users\\PrithaDutta\\Desktop\\soapui\\Delete_emp.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("Properties")
count = PropertiesTestStep.getPropertyValue("counter").toInteger()
//If Total records is unknown (at start), get the rowcount from Excel
if (PropertiesTestStep.getPropertyValue("total").toString() == "")
    PropertiesTestStep.setPropertyValue("total", Sheet1.getRows().toString())
count++
//Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
log.info("Count is " + count.toString() + " empid : " + Field1.getContents())
                
//Close workbook.
WorkBook1.close()
//Copy the Excel test data to properties in Properties test step



//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("empid", Field1.getContents())

PropertiesTestStep.setPropertyValue("counter", count.toString())
// check the counter value is less than total no of rows. If same set prop 'end' to 'true'
if (count == PropertiesTestStep.getPropertyValue("total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("end", "true")</script></con:config></con:testStep><con:testStep type="properties" name="Properties" id="02effa80-2959-4570-8b79-10aaeb40591f"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>empid</con:name><con:value>98586</con:value></con:property><con:property><con:name>counter</con:name><con:value>1</con:value></con:property><con:property><con:name>total</con:name><con:value>5</con:value></con:property><con:property><con:name>end</con:name><con:value>false</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="REST RequestforDelete" id="fbf1dba5-5216-4a4d-a018-0901043d16fd"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/delete/{empid}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="REST Request" id="78603913-2b8f-4b4c-9c36-39d9f28cb433" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/deleteIBMMANIPALPRO</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="empid" value="${Properties#empid}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>empid</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="DataSourceLoopforDelete" id="4433f276-ed50-496d-8f93-6eb98a6a3a84"><con:settings/><con:config><script/></con:config></con:testStep><con:testStep type="groovy" name="Cleanupfordelete" id="3a0cc69a-7ef7-4fb1-8cb4-108e25dc37a7"><con:settings/><con:config><script/></con:config></con:testStep><con:properties/></con:testCase>